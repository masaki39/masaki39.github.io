---
date: 2024-04-01
updated: 2024-04-01
aliases:
  - ğŸ“˜Templaterã®çµæœã‚’ç‰¹å®šã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å‡ºåŠ›
tags:
  - note/article
title: ğŸ“˜Templaterã®çµæœã‚’ç‰¹å®šã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å‡ºåŠ›
---
# ã¯ã˜ã‚ã«

2é€±é–“å‰ã‹ã‚‰ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§æ–‡ç« ã‚’æ›¸ãã¨ã„ã†æ–¹æ³•ã‚’è¡Œã£ã¦ã„ã‚‹

> [!note] seealso
> [[ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§è‹±æ–‡ã‚’æ›¸ã|ğŸ“˜ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§è‹±æ–‡ã‚’æ›¸ã]]

ã“ã®æ–¹æ³•ã¯Outlinerãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½µç”¨ã™ã‚‹ã¨ã‹ãªã‚Šä¾¿åˆ©ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ãŸ


- ã¯ã˜ã‚ã«
	- æ¦‚è¦
		- ä¾‹ãˆã°ã“ã®ã‚ˆã†ãªæ–‡ç« ã‚’æ›¸ãã¨ã™ã‚‹ã€‚
		- ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§æ›¸ãã¨ã€ä¸€æ–‡ãšã¤è¦ç´ ã¨ã—ã¦èªè­˜ã§ãã‚‹ã€‚
		- ã•ã‚‰ã«ä¸‹å±¤ã«è‹±èªã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã€å‚™è€ƒã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã§ãã‚‹ã€‚
			- è£œè¶³èª¬æ˜ã‚’ã„ã‚ŒãŸã‚Š
		- Outlinerãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆãŸã‚Šã‚‚ã§ãã‚‹ã€‚

ã“ã®ã‚ˆã†ãªã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã«å‰è¨˜äº‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã†ã¨

> [!example]ã€€ã“ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã‚‹
> 
> ã¯ã˜ã‚ã«
> 
> ä¾‹ãˆã°ã“ã®ã‚ˆã†ãªæ–‡ç« ã‚’æ›¸ãã¨ã™ã‚‹ã€‚ ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§æ›¸ãã¨ã€ä¸€æ–‡ãšã¤è¦ç´ ã¨ã—ã¦èªè­˜ã§ãã‚‹ã€‚ ã•ã‚‰ã«ä¸‹å±¤ã«è‹±èªã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã€å‚™è€ƒã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã§ãã‚‹ã€‚ Outlinerãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆãŸã‚Šã‚‚ã§ãã‚‹ã€‚ 

ä»Šå›ã¯ã€ã“ã®å‡ºåŠ›ã‚’ç‰¹å®šã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¡Œãˆãªã„ã‹ã¨è€ƒãˆãŸ

ç†ç”±ã¯Better Word Countãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ï½¢Display Section Word Countï½£ã¨ã„ã†è¨­å®šé …ç›®ãŒã‚ã‚Šã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ–‡å­—ã‚’è‡ªå‹•ã§æ•°ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã 

ä¾‹â†“â†“
![](https://filedn.com/lF97wFVWosQpHEoDAbvva0h/Publish/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202024-04-01%2022.53.16.png)

Outputã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¢ã—ã¦`replaceRange`ã§çµæœã‚’å‡ºåŠ›ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```js
// ä»¥ä¸‹`# Output`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«çµæœã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰
let startLine = null;
let endLine = null;
let endCh = null;

for (let index = 0; index < lines.length; index++) {
    const line = lines[index].trim(); // å‰å¾Œã®ç©ºç™½ã‚’å–ã‚Šé™¤ã„ã¦åˆ¤å®šã™ã‚‹
    if (line === `# Output`) { // é–‹å§‹è¡Œ
        startLine = index + 1 ;
    } else if (line.startsWith(`# `) && startLine !== null && endLine === null) { //ã€€çµ‚äº†è¡Œ
        endLine = index - 1;
        endCh = lines[endLine].length;
        break; 
    }
}

// endLineãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯æœ€å¾Œã®è¡Œã‚’çµ‚äº†è¡Œã«ã™ã‚‹
if (startLine !== null && endLine === null) {
    endLine = lines.length - 1; //ã€€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹èª¿æ•´
    endCh = lines[endLine].length;
}

if (startLine !== null && endLine !== null) {
    app.workspace.activeLeaf.view.editor.replaceRange(finalResult, {line: startLine, ch: 0}, {line: endLine, ch: endCh});
    app.workspace.activeLeaf.view.editor.setCursor(startLine, 0) // ã‚«ãƒ¼ã‚½ãƒ«ã‚’å‡ºåŠ›éƒ¨ã«ç§»å‹•
}
```

`editor.replaceRange`ã¯çµæœã¨é–‹å§‹ä½ç½®ã€çµ‚äº†ä½ç½®ã‚’æŒ‡å®šã™ã‚‹ã¨ã€çµæœã‚’æŒ‡å®šã—ãŸç¯„å›²ã‚’æ›´æ–°ã™ã‚‹å½¢ã§å‡ºåŠ›ã™ã‚‹

1. å„è¡Œãƒã‚§ãƒƒã‚¯ã—ã¦ã€`#Output`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¢ã—ã¦ã€æ¬¡ã®`# `ã¾ã§ã‚’ç¯„å›²ã«æŒ‡å®šã™ã‚‹
2. æ¬¡ã®`# `ãŒãªã‘ã‚Œã°æœ€çµ‚è¡Œã‚’çµ‚äº†ä½ç½®ã«æŒ‡å®šã™ã‚‹
3. å–å¾—ã—ãŸç¯„å›²ã«çµæœ(`finalResult`)ã‚’å‡ºåŠ›ã™ã‚‹

ã“ã‚Œã‚’å‰å›ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨åˆä½“ï¼ï¼

```js
// æœ¬æ–‡ã‚’è¡Œã”ã¨ã®ãƒªã‚¹ãƒˆã«ã™ã‚‹
const lines = tp.file.content.split('\n');

// å„è¡Œã‚’å¤‰æ›ã™ã‚‹
let result = [];
lines.forEach(line => {
	if (line.startsWith(`- `)){
	    result.push(`\n\n${line.trim().slice(2)}`); // trimã§ç©ºç™½ã‚’æ¶ˆã—ã¦å‰ã®ï¼’æ–‡å­—`- `ã‚’æ¶ˆã™
	} else if (line.startsWith(`\t- `)){
		result.push(`\n\n`);
	} else if (line.startsWith(`\t\t- `)) {
		result.push(`${line.trim().slice(2)} `);
	}
});
const finalResult = result.join('').slice(1);
navigator.clipboard.writeText(finalResult) //ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼

// ä»¥ä¸‹`# Output`ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«çµæœã‚’å‡ºåŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰
let startLine = null;
let endLine = null;
let endCh = null;

for (let index = 0; index < lines.length; index++) {
    const line = lines[index].trim(); // å‰å¾Œã®ç©ºç™½ã‚’å–ã‚Šé™¤ã„ã¦åˆ¤å®šã™ã‚‹
    if (line === `# Output`) { // é–‹å§‹è¡Œ
        startLine = index + 1 ;
    } else if (line.startsWith(`# `) && startLine !== null && endLine === null) { //ã€€çµ‚äº†è¡Œ
        endLine = index - 1;
        endCh = lines[endLine].length;
        break; 
    }
}

// endLineãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã¯æœ€å¾Œã®è¡Œã‚’çµ‚äº†è¡Œã«ã™ã‚‹
if (startLine !== null && endLine === null) {
    endLine = lines.length - 1; //ã€€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹èª¿æ•´
    endCh = lines[endLine].length;
}

if (startLine !== null && endLine !== null) {
    app.workspace.activeLeaf.view.editor.replaceRange(finalResult, {line: startLine, ch: 0}, {line: endLine, ch: endCh});
    app.workspace.activeLeaf.view.editor.setCursor(startLine, 0) // ã‚«ãƒ¼ã‚½ãƒ«ã‚’å‡ºåŠ›éƒ¨ã«ç§»å‹•
}
```

çµæœã‚’`# Outputã‚»ã‚¯ã‚·ãƒ§ãƒ³`ã«å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒãªãã¦ã‚‚ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã¯ã•ã‚Œã‚‹
å®Œæˆã—ãŸ

æœ€å¾Œã«
ã“ã®ãƒšãƒ¼ã‚¸ã§ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã£ã¦ã¿ã‚‹
# Output

ã¯ã˜ã‚ã«

ä¾‹ãˆã°ã“ã®ã‚ˆã†ãªæ–‡ç« ã‚’æ›¸ãã¨ã™ã‚‹ã€‚ ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã§æ›¸ãã¨ã€ä¸€æ–‡ãšã¤è¦ç´ ã¨ã—ã¦èªè­˜ã§ãã‚‹ã€‚ ã•ã‚‰ã«ä¸‹å±¤ã«è‹±èªã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã€å‚™è€ƒã‚’ã„ã‚Œã¦ã¿ãŸã‚Šã§ãã‚‹ã€‚ Outlinerãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§é †ç•ªã‚’å…¥ã‚Œæ›¿ãˆãŸã‚Šã‚‚ã§ãã‚‹ã€‚ 

# ãŠã‚ã‚Šã«

ã“ã®ã‚µã‚¤ãƒˆã§ã¯è¡¨ç¤ºã•ã‚Œãªã„ãŒã€Obsidianä¸Šã§ã¯æ–‡å­—æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’è¿½è¨˜ã—ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæ›´æ–°ã•ã‚Œã‚‹
ã™ãã«ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³å¼ã®æ–‡ç« ã‚’å‡ºåŠ›ã—ã¦æ–‡å­—æ•°ã‚’ç¢ºèªã—ãŸã‚Šã‚³ãƒ”ãƒšã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ

ã“ã®å„è¡Œãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚„ã‚Šæ–¹ã¯ã‹ãªã‚Šä¸‡èƒ½æ„ŸãŒã‚ã£ã¦ãŠã™ã™ã‚ã§ãã‚‹æ–¹æ³•ã ã¨æ€ã†